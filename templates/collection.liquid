{% comment %} {% paginate collection.products by 2 %}
  <h1>{{ collection.title }}</h1>
  {% for product in collection.products %}
    <div>
      <a href="{{ product.url | within: collection }}">{{ product.title }}</a>
      {{ product.price | money }}
      {% unless product.available %}<br><strong>sold out</strong>{% endunless %}
      <a href="{{ product.url | within: collection }}">
        <img src="{{ product.featured_image.src | img_url: 'large' }}" alt="{{ product.featured_image.alt | escape }}">
      </a>
    </div>
  {% else %}
    <p>no matches</p>
  {% endfor %}
  {% if paginate.pages > 1 %}
    {{ paginate | default_pagination }}
  {% endif %}
{% endpaginate %}
list {% endcomment %}
<section>
  <div class="page-header">
      <div class="container">
          <div class="cloud-1">
              <img src="{{"cloud-1.svg" | asset_url}}" alt="">
          </div>
          <div class="cloud-2">
              <img src="{{"cloud-1.svg" | asset_url}}" alt="">
          </div>
          <div class="cloud-3">
              <img src="{{"cloud-1.svg" | asset_url}}" alt="">
          </div>
          <div class="cloud-4">
              <img src="{{"cloud-1.svg" | asset_url}}" alt="">
          </div>
          <h2 class="title-en">Collection</h2>
          <h3 class="title-jp">{{ collection.title }} の商品一覧</h3>
          
      </div>
      <div class="bg-anim-1"></div>
      <div class="bg-anim-2"></div>
      <div class="bg-anim-3"></div>
  </div>
</section>
{% render 'breadcrumbs' %}

{% if collection.handle %}

{% else %}
  <section>
    <div class="list-best-product">
        <div class="container">
            <div class="main-title mx-auto">
                <h2>Best Product</h2>
                <p>人気ランキング</p>
            </div>
            <div class="row g-4 pt-4 product-best">
              {% for product in collections.best-products.products limit:4 %}
                <div class="col-lg-3 col-sm-6 product-item-{{ forloop.index }}">
                  <div class="col-inner">
                    <div class="box-product">
                        <div class="img-product wishlist-box">
                          <a href="{{ product.url | within: collection }}">
                            <img src="{{ product.featured_image.src | img_url: 'large' }}" alt="{{ product.featured_image.alt | escape }}">
                          </a>
                        </div>
                        <div class="box-title-product">
                            <a href="{{ product.url | within: collection }}">{{ product.title }}</a>
                            <div class="price-product">
                                <p>{{ product.price | money }}</p><span>{{ product.compare_at_price | money }}</span>
                            </div>
                        </div>
                        <div class="box-rate-product">
                            <div class="rate-product">
                                {% render 'product-review' product: product,  handle:product.handle %}
                            </div>
                            <div class="box-btn-add-cart">
                              {% render 'product-card' product: product %}
                            </div>
                        </div>
                    </div>
                  </div>
                </div>
              {% endfor %}
            <div>
                </div>
            </div>
        </div>
    </div>
  </section>
{% endif %}

{%- capture productTemplate -%}{% render 'globo.filter.product', themeTranslation: shop.metafields.globoFilter.themeTranslation.value[request.locale.iso_code] %}{%- endcapture -%}{%- unless productTemplate contains 'Liquid error' -%}<script id="gspfProduct" type="template/html">{{- productTemplate | replace: "script>", "scripttag>" -}}</script>{%- endunless -%}
<section>
  <div class="list-product">
      <div class="container">
          <div class="main-title mx-auto">
              <h2>Product list</h2>
              <p>商品一覧</p>
          </div>

          <form>
            {%- for filter in collection.filters -%}
              <details>
                <summary>
                  <div>
                    <span>{{ filter.label }}</span>
          
                    {%- if filter.active_values.size > 0 -%}
                      <span>({{ filter.active_values.size }})</span>
                    {%- endif -%}
                  </div>
                </summary>
          
                <div>
                  <div>
                    <p>{{ filter.active_values.size }} selected</p>
                    {%- if filter.active_values.size > 0 -%}
                      <p><a href="{{ filter.url_to_remove }}">Reset</a></p>
                    {%- endif -%}
                  </div>
                  {%- case filter.type -%}
                    {%- when 'boolean' -%}
                      <ul>
                          <li>
                            <label for="Filter-{{ filter.param_name }}-{{ filter.true_value.value }}">
                            <input type="checkbox"
                              name="{{ filter.param_name }}"
                              value="{{ filter.true_value.value }}"
                              id="Filter-{{ filter.param_name }}"
                              {% if filter.true_value.active -%}checked{%- endif %}
                              {% if filter.true_value.count == 0 and filter.true_value.active == false -%}disabled{%- endif -%}
                            >{{ filter.true_value.label }}</label>
                          </li>
                          <li>
                            <label for="Filter-{{ filter.param_name }}-{{ filter.false_value.value }}">
                            <input type="checkbox"
                              name="{{ filter.param_name }}"
                              value="{{ filter.false_value.value }}"
                              id="Filter-{{ filter.param_name }}"
                              {% if filter.false_value.active -%}checked{%- endif %}
                              {% if filter.false_value.count == 0 and filter.false_value.active == false -%}disabled{%- endif %}
                            >{{ filter.false_value.label }}</label>
                          </li>
                      </ul>
          
                      <div>
                        <input type="submit" value="Apply">
                      </div>
                    {%- when 'list' -%}
                      <ul>
                        {%- for filter_value in filter.values -%}
                          <li>
                            <label for="Filter-{{ filter.param_name }}-{{ forloop.index }}">
                            <input type="checkbox"
                              name="{{ filter_value.param_name }}"
                              value="{{ filter_value.value }}"
                              id="Filter-{{ filter.param_name }}-{{ forloop.index }}"
                              {% if filter_value.active -%}checked{%- endif %}
                              {% if filter_value.count == 0 and filter_value.active == false -%}disabled{%- endif %}
                            >
                              <span>
                                {%- case filter_value.display.type -%}
                                  {%- when 'colors' -%}
                                    {% liquid
                                      assign size_limit = filter_value.display.value.size | at_most: 4
                                      assign rotation = '0deg'
                                      if size_limit == 2
                                        assign rotation = '45deg'
                                      endif
          
                                      assign angle_increment = 360 | divided_by: size_limit
                                      assign angle = 0
                                    %}
                                    {%- capture conic_gradient -%}
                                      {%- for color in filter_value.display.value limit: size_limit -%}
                                        {{ color }} {{ angle }}deg{%- assign angle = angle | plus: angle_increment %} {{ angle }}deg{%- unless forloop.last %}, {%- endunless -%}
                                      {%- endfor -%}
                                    {%- endcapture -%}
                                    <span style="
                                      width: 25px;
                                      height: 25px;
                                      border-radius: 50%;
                                      display: flex;
                                      justify-content: center;
                                      align-items: center;
                                      background: conic-gradient({{ conic_gradient }}); transform: rotateZ({{ rotation }});
                                    "></span>
                                  {%- when 'image' -%}
                                    {{
                                      filter_value.display.value
                                      | image_url: width: 25
                                      | image_tag: alt: filter_value.display.value.alt
                                    }}
                                  {%- else -%}
                                    <span class="visual-display__child"></span>
                                {%- endcase -%}
                              </span>
                              {{ filter_value.label }}
                            </label>
                          </li>
                        {%- endfor -%}
                      </ul>
          
                      <div>
                        <input type="submit" value="Apply">
                      </div>
                    {%- when 'price_range' -%}
                      <div class="filter-group-display__price-range">
                        <div class="filter-group-display__price-range-from">
                          <span>{{ cart.currency.symbol }}</span>
          
                          <input name="{{ filter.min_value.param_name }}"
                            id="Filter-{{ filter.min_value.param_name }}"
                            {% if filter.min_value.value -%}
                              value="{{ filter.min_value.value | money_without_currency | replace: ',', '' }}"
                            {%- endif %}
                            type="number"
                            placeholder="0"
                            min="0"
                            max="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                          >
          
                          <label for="Filter-{{ filter.min_value.param_name }}">From</label>
                        </div>
                        <div class="filter-group-display__price-range-to">
                          <span>{{ cart.currency.symbol }}</span>
          
                          <input name="{{ filter.max_value.param_name }}"
                            id="Filter-{{ filter.max_value.param_name }}"
                            {% if filter.max_value.value -%}
                              value="{{ filter.max_value.value | money_without_currency | replace: ',', '' }}"
                            {%- endif %}
                            type="number"
                            placeholder="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                            min="0"
                            max="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                          >
          
                          <label for="Filter-{{ filter.max_value.param_name }}">To</label>
                        </div>
                      </div>
          
                      <div class="filter-group-display__submit">
                        <input type="submit" value="Apply">
                      </div>
                  {%- endcase -%}
                </div>
              </details>
            {%- endfor -%}
          
            <div>
              <p><a href="{{ collection.url }}?sort_by={{ collection.sort_by }}">Clear all</a></p>
          
              {%- for filter in collection.filters -%}
                {%- if filter.type == "price_range" -%}
                  {%- if filter.min_value.value != nil or filter.max_value.value != nil -%}
                    <p>
                      <a href="{{ filter.url_to_remove }}">
                        {%- assign min_value = filter.min_value.value | default: 0 -%}
                        {%- assign max_value = filter.max_value.value | default: filter.range_max -%}
                        {{ min_value | money }} - {{ max_value | money }} X
                      </a>
                    </p>
                  {%- endif -%}
                {%- else -%}
                  {%- for filter_value in filter.active_values -%}
                    <p>
                      <a href="{{ filter_value.url_to_remove }}">
                        {{ filter.label }}: {{ filter_value.label }} X
                      </a>
                    </p>
                  {%- endfor -%}
                {%- endif -%}
              {%- endfor -%}
            </div>
          </form>
          

          <div class="row py-5">
            <div class="col-lg-8 col-sm-12">
                <div class="col-inner">
                    <div class="box-product-filter">
                        <label for="#"><span>キーワードで探す</span><input type="text" class="form-control" placeholder="キーワードを入力"></label>
                        <label for="#">
                            <span>カテゴリー</span>
                            <select id="collection_list">
                                <option value="/collections/all">商品一覧</option>
                                {%- for collection in collections -%}
                                  <option value="/collections/{{ collection.handle }}">{{ collection.title }}</option>
                                {%- endfor -%}
                            </select>
                        </label>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-sm-12">
                <div class="col-inner">
                    <div class="box-product-filter-price">
                        <label for="#">
                            <span>価格帯で絞り込む</span>
                            <input type="text" class="form-control" placeholder="">
                            <span>～</span>
                            <input type="text" class="form-control" placeholder="">
                        </label>
                    </div>
                </div>
            </div>
          </div>
      
          {% paginate collection.products by 12 %}
            <div class="row pt-3">
              {% for product in collection.products %}
                <div class="col-lg-3 col-sm-6">
                  <div class="col-inner">
                      <div class="box-product">
                          <div class="img-product wishlist-box">
                            <a href="{{ product.url | within: collection }}">
                              <img src="{{ product.featured_image.src | img_url: 'large' }}" alt="{{ product.featured_image.alt | escape }}">
                            </a>
                          </div>
                          <div class="box-title-product">
                              <a href="{{ product.url | within: collection }}">{{ product.title }}</a>
                              <div class="price-product">
                                  <p>{{ product.price | money }}</p><span>{{ product.compare_at_price | money }}</span>
                              </div>
                          </div>
                          <div class="box-rate-product">
                              <div class="rate-product">
                                  {% render 'product-review' product: product,  handle:product.handle %}
                              </div>
                              <div class="box-btn-add-cart">
                                {% render 'product-card' product: product %}
                              </div>
                          </div>
                      </div>
                  </div>
                </div>
              {% else %}
                <div class="alert alert-danger" role="alert">
                  No matches
                </div>
              {% endfor %}
            </div>
            {% if paginate.pages > 1 %}<div class="pagination-wrapper">{{ paginate | default_pagination }}</div>{% endif %}
          {% endpaginate %}
            
      </div>
  </div>
</section>